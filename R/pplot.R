#' Plot polygonal symbolic variable
#'
#' @description Prints all overlaid polygons in the display. The polygons obtained through classes.
#' 
#' @param polygon A list of matrices with dimension l x 2 where l represents vertices number of polygon.
#' @param center logical. iF FALSE(the default) the center of polygon is not displayed.
#' @param color A string that describes the color of center.
#' @examples 
#' x <- psim(10, 10) #simulate 10 polygons of 10 sides
#' pplot(x, center = T, color = 'red')
#' @export
pplot <- function(polygon, center = F, color = 'black'){
  polygon <- lapply(polygon, function(x) {colnames(x) <- NULL; x})
  g <- ggplot2::ggplot()
  names(polygon) = 1:length(polygon)
  k <- plyr::ldply(polygon, function(x) data.frame(x))
  g <- ggplot2::ggplot(k, ggplot2::aes(x = k$X1, y = k$X2, group = k$.id)) + 
    ggplot2::geom_polygon(colour = "black", fill = NA)
  
  g <- g + ggplot2::xlab('Dimension 1') + ggplot2::ylab('Dimension 2')
  
  if(center){
    pol_center <- data.frame(.id = 1 : length(polygon),  t(sapply(polygon, pmean_id)))
    names(pol_center) <- names(k)
    g <- g + geom_point(data = pol_center, aes(x = X1, y = X2, group = .id), color = color)
  }
  return(g)
}